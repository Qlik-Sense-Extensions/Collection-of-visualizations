var visualize=function(e,a,t,l){function n(e,a,n){var o=a.qInfo.qId+"_chartjs_bubble",i=l.calculateMargin(e,a),s=i[0],r=i[1],u=[],c=0;"auto"==a.colors?(u=l.defineColorPalette("palette"),c=a.color):u=a.custom_colors.split("-");var b="rgba("+u[c]+","+a.opacity+")";e.html('<canvas id="'+o+'" width="'+s+'" height="'+r+'"></canvas>');var d=n,m=a.qHyperCube.qMeasureInfo.length,q="",f=a.bubble_size,p=d.length;if(3==m){var h=p>30?30:p,v=a.qHyperCube.qMeasureInfo[2].qMin,g=a.qHyperCube.qMeasureInfo[2].qMax;q=g-v>0?(g-v)/h:g/h}a.cumulative&&(d=l.addCumulativeValues(d));var y=document.getElementById(o);new Chart(y,{type:"bubble",data:{datasets:[{label:a.qHyperCube.qDimensionInfo[0].qFallbackTitle,data:d.map(function(e){return 2==m?{label:e[0].qText,x:e[1].qNum,y:e[2].qNum,r:f}:{label:e[0].qText,x:e[1].qNum,y:e[2].qNum,z:e[3].qNum,r:Math.floor(e[3].qNum/q/h*f)}}),backgroundColor:b,borderColor:b,borderWidth:1}]},options:{title:{display:a.title_switch,text:a.title},legend:{display:"hide"!=a.legend_position,position:a.legend_position,onClick:function(e,a){}},scales:{xAxes:[{scaleLabel:{display:a.datalabel_switch,labelString:a.qHyperCube.qMeasureInfo[0].qFallbackTitle},ticks:{beginAtZero:!0,callback:function(e,t,n){return l.formatMeasure(e,a,0)}}}],yAxes:[{scaleLabel:{display:a.datalabel_switch,labelString:a.qHyperCube.qMeasureInfo[1].qFallbackTitle},ticks:{beginAtZero:!0,callback:function(e,t,n){return l.formatMeasure(e,a,1)}}}]},tooltips:{mode:"label",callbacks:{label:function(e,t){var n=t.datasets[0].data[e.index].label+": "+l.formatMeasure(t.datasets[0].data[e.index].x,a,0)+", "+l.formatMeasure(t.datasets[0].data[e.index].y,a,1);return 2==m?n:n+", "+l.formatMeasure(t.datasets[0].data[e.index].z,a,2)}}},responsive:!0,events:["mousemove","mouseout","click","touchstart","touchmove","touchend"],onClick:function(e){var a=this.getElementsAtEvent(e);a.length>0&&l.makeSelectionsOnDataPoints(d[a[0]._index][0].qElemNumber,t)}}})}l.pageExtensionData(t,e,a,n)};