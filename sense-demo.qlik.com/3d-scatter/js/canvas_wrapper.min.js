var m=Math;var mr=m.round;var ms=m.sin;var mc=m.cos;var abs=m.abs;var sqrt=m.sqrt;function createMatrixIdentity(){return[[1,0,0],[0,1,0],[0,0,1]]}function matrixMultiply(d,c){var b=createMatrixIdentity();for(var a=0;a<3;a++){for(var g=0;g<3;g++){var e=0;for(var f=0;f<3;f++){e+=d[a][f]*c[f][g]}b[a][g]=e}}return b}function copyState(b,a){a.fillStyle=b.fillStyle;a.lineCap=b.lineCap;a.lineJoin=b.lineJoin;a.lineWidth=b.lineWidth;a.miterLimit=b.miterLimit;a.shadowBlur=b.shadowBlur;a.shadowColor=b.shadowColor;a.shadowOffsetX=b.shadowOffsetX;a.shadowOffsetY=b.shadowOffsetY;a.strokeStyle=b.strokeStyle;a.globalAlpha=b.globalAlpha}function CanvasWrapper(a){this.m_=createMatrixIdentity();this.mStack_=[];this.aStack_=[];this.canvas=a;this.strokeStyle="#000";this.fillStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=1;this.globalAlpha=1}var cwPrototype=CanvasWrapper.prototype;cwPrototype.applyContextProperties=function(){this.canvas.strokeStyle=this.strokeStyle;this.canvas.fillStyle=this.fillStyle;this.canvas.lineWidth=this.lineWidth;this.canvas.lineJoin=this.lineJoin;this.canvas.lineCap=this.lineCap;this.canvas.miterLimit=this.miterLimit;this.canvas.globalAlpha=this.globalAlpha;this.canvas.font=this.font};cwPrototype.beginPath=function(){this.canvas.beginPath()};cwPrototype.moveTo=function(b,a){this.canvas.moveTo(b,a);var c=this.getCoords(b,a);this.currentX_=c.x;this.currentY_=c.y};cwPrototype.lineTo=function(b,a){this.applyContextProperties();this.canvas.lineTo(b,a);var c=this.getCoords(b,a);this.currentX_=c.x;this.currentY_=c.y};cwPrototype.bezierCurveTo=function(c,a,f,e,d,b){this.applyContextProperties();this.canvas.bezierCurveTo(c,a,f,e,d,b);var g=this.getCoords(d,b);this.currentX_=g.x;this.currentY_=g.y};cwPrototype.quadraticCurveTo=function(e,c,b,a){this.applyContextProperties();this.canvas.quadraticCurveTo(e,c,b,a);var d=this.getCoords(b,a);this.currentX_=d.x;this.currentY_=d.y};cwPrototype.arc=function(e,d,f,c,b,a){this.applyContextProperties();this.canvas.arc(e,d,f,c,b,a)};cwPrototype.rect=function(c,b,a,e){this.applyContextProperties();this.canvas.rect(c,b,a,e);var d=this.getCoords(c,b);this.currentX_=d.x;this.currentY_=d.y};cwPrototype.strokeRect=function(c,b,a,e){this.applyContextProperties();this.canvas.strokeRect(c,b,a,e);var d=this.getCoords(c,b);this.currentX_=d.x;this.currentY_=d.y};cwPrototype.fillRect=function(c,b,a,e){this.applyContextProperties();this.canvas.fillRect(c,b,a,e);var d=this.getCoords(c,b);this.currentX_=d.x;this.currentY_=d.y};cwPrototype.createLinearGradient=function(b,d,a,c){this.applyContextProperties();return this.canvas.createLinearGradient(b,d,a,c)};cwPrototype.createRadialGradient=function(d,f,c,b,e,a){this.applyContextProperties();return this.canvas.createRadialGradient(d,f,c,b,e,a)};cwPrototype.stroke=function(a){this.applyContextProperties();this.canvas.stroke(a)};cwPrototype.fill=function(){this.applyContextProperties();this.canvas.fill()};cwPrototype.clearRect=function(c,b,a,d){this.canvas.clearRect(c,b,a,d)};cwPrototype.closePath=function(){this.canvas.closePath()};cwPrototype.measureText=function(a){this.applyContextProperties();return this.canvas.measureText(a)};cwPrototype.fillText=function(d,c,b,a){this.applyContextProperties();this.canvas.fillText(d,c,b,a)};cwPrototype.createPattern=function(b,a){this.canvas.createPattern(b,a)};cwPrototype.getCoords=function(c,b){var a=this.m_;return{x:c*a[0][0]+b*a[1][0]+a[2][0],y:c*a[0][1]+b*a[1][1]+a[2][1]}};cwPrototype.save=function(){this.canvas.save();var a={};copyState(this,a);this.aStack_.push(a);this.mStack_.push(this.m_);this.m_=matrixMultiply(createMatrixIdentity(),this.m_)};cwPrototype.restore=function(){this.canvas.restore();copyState(this.aStack_.pop(),this);this.m_=this.mStack_.pop()};function matrixIsFinite(a){for(var c=0;c<3;c++){for(var b=0;b<2;b++){if(!isFinite(a[c][b])||isNaN(a[c][b])){return false}}}return true}function setM(b,a){if(!matrixIsFinite(a)){return}b.m_=a}cwPrototype.setMatrix=function(a){this.setTransform(a[0][0],a[0][1],a[1][0],a[1][1],a[2][0],a[2][1])};cwPrototype.getMatrix=function(){return this.m_};cwPrototype.translate=function(c,b){this.canvas.translate(c,b);var a=[[1,0,0],[0,1,0],[c,b,1]];setM(this,matrixMultiply(a,this.m_))};cwPrototype.rotate=function(b){this.canvas.rotate(b);var e=mc(b);var d=ms(b);var a=[[e,d,0],[-d,e,0],[0,0,1]];setM(this,matrixMultiply(a,this.m_))};cwPrototype.scale=function(c,b){this.canvas.scale(c,b);var a=[[c,0,0],[0,b,0],[0,0,1]];setM(this,matrixMultiply(a,this.m_))};cwPrototype.transform=function(e,d,g,f,b,a){this.canvas.transform(e,d,g,f,b,a);var c=[[e,d,0],[g,f,0],[b,a,1]];setM(this,matrixMultiply(c,this.m_))};cwPrototype.setTransform=function(e,d,g,f,c,b){this.canvas.setTransform(e,d,g,f,c,b);var a=[[e,d,0],[g,f,0],[c,b,1]];setM(this,a)};