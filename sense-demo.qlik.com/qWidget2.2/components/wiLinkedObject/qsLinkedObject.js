define(["jquery","underscore","qvangular","angular","objects.extension/base-controller","qlik","text!./qsLinkedObject.DummyImage.ng.html"],function(a,b,c,d,e,f,g){"use strict";c.directive("qsLinkedObject",["$timeout","$interval","$compile",function(c,e,h){return{restrict:"E",scope:!0,replace:!0,transclude:!0,link:function(c,i){function j(){if(c.inEditMode){i.empty();var b=h(g)(c);i.append(b)}else if(void 0!==c.object&&c.dataBoundId!==c.object){var j=a(document.createElement("div"));j.css("height","100%"),j.css("width","100%"),j.attr("data-qvid",c.object),k.getObject(j,c.object).then(function(){var b=0,g=e(function(){b++;var h=j.find("*");h.has("article")?(e.cancel(g),h.each(function(){a(this).addClass("wi-nobs")}),i.empty(),i.append(j),f.resize(c.dataBoundId)):d.noop(),b>=50&&e.cancel(g)},200);m.push(g)}).catch(function(){d.noop()}).finally(function(){d.noop()})}}var k,l=[],m=[];return i.addClass("qWidget_qsLinkedObject"),c.getElementDimensions=function(){return c.inEditMode?{h:i.closest(".wiView_htmlContainer").height,w:i.closest(".wiView_htmlContainer").width()}:{h:i.closest(".cell").height,w:i.closest(".cell").width()}},c.$watch(c.getElementDimensions,function(a,b){void 0!==a&&a!==b&&f.resize(c.object)},!0),c.$watch("inEditMode",function(){j()}),i.on("resize",function(){c.$apply()}),void 0!==c.object?(k=f.currApp(),void j()):void c.$on("$destroy",function(){i.remove(),i.off(),b.each(l,function(a){a()}),b.each(m,function(a){a&&e.cancel(a)})})}}}])});