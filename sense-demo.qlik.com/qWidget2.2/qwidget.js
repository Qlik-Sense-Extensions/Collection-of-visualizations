define(["jquery","underscore","moment","qvangular","angular","qlik","ng!$http","ng!$q","ng!$timeout","ng!$compile","./qwidget-properties","./qwidget-initialproperties","./config/config","text!./partials/main.html","./modules/utils/wiUtils","./lib/assets/colorpicker/colorpicker-directive","./directives/wiDirectiveLoader","./modules/modulesLoader","./services/wiShorthandNotation","./partials/WidgetEditor/Snippets/wiWidgetEditor.PopupSnippets","./partials/WidgetEditor/Variables/wiWidgetEditor.PopupVariables","./partials/WidgetEditor/Icons/wiWidgetEditor.PopupIcons","./partials/General/Help/wiWidgetEditor.PopupHelp","./partials/WidgetEditor/Publishing/wiWidgetEditor.PopupPublisher","./core/WorkingArea/general/about/wiAbout","./partials/General/Error/wiError","./core/WorkingArea/general/Authentication/wiAuthentication","./core/WorkingArea/general/UpdateInfo/wiUpdateInfo","./core/filter/filterLoader","./lib/assets/wiAssetLoader","./services/wiService","./services/wiPopupExportService","./services/wiRepositoryService","./services/wiLocalRepositoryService","./services/wiMainRepositoryService","./services/wiOnlineRepositoryService","./services/wiEditorService","./lib/external/elementQuery/elementQuery"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){"use strict";a(document.body).append('<div id="wipopup"></div>');var C="/extensions/qwidget/lib/external/fontawesome/css/font-awesome.min.css";o.addStyleLinkToHeader("wiFonts-fa",C);var D="/extensions/qwidget/lib/css/wiStyles.css";return o.addStyleLinkToHeader("wiStyles",D),o.addStyleLinkToHeader("wiBootstrap","/extensions/qWidget/components/wiBootstrap/css/wiBootstrap.css"),{definition:k,template:n,initialProperties:l,snapshot:{canTakeSnapshot:!0},resize:function(a){elementQueryInit()},paint:function(){elementQueryInit()},controller:["$scope","$window","wiService","wiRepositoryService","wiMainRepositoryService","wiLocalRepositoryService","wiOnlineRepositoryService","wiPopupExportService","wiEditorService",function(c,d,f,h,j,k,l,n,p){var q=c.$parent.options.id;c.initWidget=function(){function a(){}a()},c.News={},c.Main={},c.Main.SupportedVersion=!0,c.Main.IsDebug="false",c.Main.editMode="",c.Main.showEditor=!1,c.Main.isLinkedObject=!b.isEmpty(c.$parent.layout.qExtendsId),c.Main.SelectedRepository=null,c.Main.RepositoryList=m.Repositories.repositories,c.Main.getObjectId=function(){return c.$parent.options.id},c.Main.isNormalMode=function(){return!c.Main.isEditMode()},c.Main.isPreviewMode=function(){return c.Main.isEditMode()&&c.Main.showEditor===!1},c.Main.isEditMode="function"==typeof c.$parent.object.inEditState?c.$parent.object.inEditState:function(){return c.$parent.$parent.editmode},c.$watch("Main.editing",function(a){c.object.preventDrag=a}),c.Main.startEditing=function(){c.editing=!0,c.object.preventDrag=!0,c.Main.MainRepository.init().finally(function(){e.noop()})},c.Main.endEditing=function(){c.editing=!1,c.object.preventDrag=!1},c.Main.switchEditMode=function(a){c.Main.editMode=a},c.Main.openEditor=function(){c.Main.switchEditMode("create"),c.Main.showEditor=!0,c.Main.startEditing()},c.Main.setClientVersion=function(){var a=["1.0.","1.1.","1.2.","2.0."],b=c.layout.clientVersion;if(void 0!==b&&"=Qli"!==b.substr(0,4)){var d=c.layout.clientVersion.substr(0,4);c.Main.SupportedClientVersion=a.indexOf(d)>-1,c.Main.ClientVersion=c.layout.clientVersion.substr(0,4)}},c.Main.getUserInfo=function(){h.getUserInfo(c).then(function(){},function(){})},c.Main.doMouseOver=function(){c.Main.mouseOver=!0},c.Main.doMouseOut=function(){c.Main.mouseOver=!1},c.Main.closeEditor=function(){c.Main.showEditor=!1,c.Main.endEditing()},c.Main.Error=null,c.Main.clearError=function(){c.Main.Error=null},c.Main.raiseError=function(b,d,e){c.Main.Error={},c.Main.Error.ErrorDesc=b,c.Main.Error.ErrorStatus=e,c.Main.Error.ErrorObject=e,a("#wipopup").showComponent(z,{Main:c.Main})},c.Main.errorHandler=function(a){c.Main.raiseError(a&&a.errorDesc?a.errorDesc:"",a&&a.errorStatus?a.errorStatus:void 0,a&&a.error?a.error:void 0)},c.Main.MainRepository=j,c.Main.MainRepository.currentVersion=c.$parent.ext.libraryInfo.version,c.Main.LocalRepository=k,c.Main.OnlineRepositoryService=l,c.Main.SelectedOnlineRepository=void 0,c.Main.Authentication={},c.Main.Authentication.logOut=function(){c.Main.SelectedOnlineRepository.logOut().then(function(){}).catch(c.Main.errorHandler)},c.Main.Authentication.authPop=function(a,d){function f(){h?h.closed&&(clearInterval(g),setTimeout(function(){c.Main.Authentication.checkAuth(d)},200)):clearInterval(g)}a||(a=c.Main.SelectedOnlineRepository.authentication.authenticationUrl);var g,h;if(b.isEmpty(a))e.noop();else{var i=500,j=600,k=screen.width/2-i/2,l=screen.height/2-j/2;h=window.open(a,"winAuth","width="+i+",height="+j+",top="+l+",left="+k+" "),h&&h.focus(),g=setInterval(f,200)}};var r={};r.visible=!1,r.show=function(){a("#wipopup").showComponent(A,{authenticationUrl:c.Main.SelectedOnlineRepository.authentication.authenticationUrl})},r.done=function(){r.visible=!1,c.Main.Authentication.checkAuth(c.WidgetLoader.loadWidgets)},c.Main.Authentication.LocalAuthentication=r,c.Main.Authentication.checkAuth=function(a){c.Main.SelectedOnlineRepository&&c.Main.SelectedOnlineRepository.isOnline&&c.Main.OnlineRepositoryService.getInstance(c.Main.SelectedRepository).then(function(b){b.checkAuthentication().then(function(){b.authentication.isAuthenticated&&a&&a()}).catch(function(a){0===a.errorStatus?(Main.raiseError("Server not available"),e.noop()):c.Main.raiseError(" Authentication.checkAuth(): An error occurred: ",a.errorStatus,a.error)}).finally(function(){})}).catch(c.Main.errorHandler)},c.wi=s.init(c.layout.qHyperCube);var C={};C.SelectedFontSize=m.EditorFontSizes[0],C.EditorFontSizes=m.EditorFontSizes,C.FontSize_OnChange=function(){var a=C.SelectedFontSize;null!==C.FontSize&&(C.htmlEditor().setFontSize(a.value),C.lessEditor().setFontSize(a.value))},C.html=void 0,C.css=void 0,C._htmlEditor=null,C.htmlEditor=function(){return null===C._htmlEditor&&(C._htmlEditor=ace.edit("htmlEditor_"+q)),C._htmlEditor},C._lessEditor=null,C.lessEditor=function(){return null===C._lessEditor&&(C._lessEditor=ace.edit("lessEditor_"+q)),C._lessEditor},C.popupTarget="html",C.toggleHtmlEditor=function(){C.MaximizedMode=!C.MaximizedMode,a("#wiEditor_EditorsContainer_"+c.layout.qInfo.qId).toggleClass("wiEditor_ColLeft"),a("#qWidget_WidgetEditor_LivePreview").toggle(),a("#qWidget_WidgetEditor_LessEditor").toggle(),a("#qWidget_WidgetEditor_HtmlEditor").toggleClass("maximized")},C.toggleLessEditor=function(){C.MaximizedMode=!C.MaximizedMode,a("#qWidget_WidgetEditor_HtmlEditor").toggle(),a("#qWidget_WidgetEditor_LivePreview").toggle(),a("#wiEditor_EditorsContainer_"+c.layout.qInfo.qId).toggleClass("wiEditor_ColLeft"),a("#qWidget_WidgetEditor_LessEditor").toggleClass("maximized")},c.WidgetEditor=C,c.WidgetEditor.insert=function(a,b){b&&(a="{{"+a+"}}"),"html"===c.WidgetEditor.popupTarget?c.WidgetEditor.htmlEditor().insert(a):c.WidgetEditor.lessEditor().insert(a),c.WidgetEditor.setPreview(),c.WidgetEditor.PopupVariables.visible=!1},c.WidgetEditor.PopupVariables={},c.WidgetEditor.PopupVariables.visible=!1,c.$watch("WidgetEditor.PopupVariables.visible",function(a){c.object.preventDrag=a}),c.WidgetEditor.popUpScope=function(b){function d(){c.WidgetEditor.PopupVariables.data=[];var a=[];a.push({cat:"General Information",key:"layout.title",val:c.layout.title,desc:"Title"}),a.push({cat:"General Information",key:"layout.subtitle",val:c.layout.subtitle,desc:"Sub Title"}),a.push({cat:"General Information",key:"layout.footnote",val:c.layout.footnote,desc:"Footnote"});for(var b=1;10>b;b++){var d=c.$parent.layout["property"+b];a.push({cat:"Custom Properties - Misc",key:"layout.property"+b,val:d,desc:"Custom Property "+b})}return a.push({cat:"Meta Information",key:"layout.qInfo.qId",val:c.layout.qInfo.qId,desc:"Object Id"}),a.push({cat:"Meta Information",key:"layout.qInfo.qType",val:c.layout.qInfo.qType,desc:"Object Type"}),a.push({cat:"Data Information",key:"layout.qHyperCube.qDataPages.length",val:c.layout.qHyperCube?c.layout.qHyperCube.qDataPages.length:"",desc:"# Datapages"}),a.push({cat:"Data Information",key:"layout.qHyperCube.qDimensionInfo.length",val:c.layout.qHyperCube?c.layout.qHyperCube.qDimensionInfo.length:"",desc:"# Dimensions"}),a.push({cat:"Data Information",key:"layout.qHyperCube.qMeasureInfo.length",val:c.layout.qHyperCube?c.layout.qHyperCube.qMeasureInfo.length:"",desc:"# Measures"}),a.push({cat:"Data Information",key:"layout.qHyperCube.qDataPages[0].qMatrix.length",val:c.layout.qHyperCube&&c.layout.qHyperCube.qDataPages.length>0&&c.layout.qHyperCube.qDataPages[0].qMatrix?c.layout.qHyperCube.qDataPages[0].qMatrix.length:"",desc:"# Rows (Datapage 1)"}),a}a("#wipopup").showComponent(u,{data:d(),insert:c.WidgetEditor.insert}),c.WidgetEditor.popupTarget=b,c.WidgetEditor.PopupVariables.visible=!0,c.object.preventDrag=!0},c.WidgetEditor.bind=function(){var a,d;b.isEmpty(c.layout.widgetHtml)&&b.isEmpty(c.layout.widgetLess)?(a=m.Editor_Default_Html,d=m.Editor_Default_Less):(a=o.stringFromEngine(c.layout.widgetHtml),d=o.stringFromEngine(c.layout.widgetLess));var e=void 0===c.WidgetEditor.html?a:c.WidgetEditor.html,f=void 0===c.WidgetEditor.less?d:c.WidgetEditor.less;c.WidgetEditor.html=e,c.WidgetEditor.less=f,c.WidgetEditor.htmlEditor().getSession().setValue(void 0===e?"":e),c.WidgetEditor.htmlEditor().gotoLine(1),c.WidgetEditor.lessEditor().getSession().setValue(void 0===f?"":f),c.WidgetEditor.lessEditor().gotoLine(1),c.WidgetEditor.setPreview()};var D={};D.Export={},D.visible=!1,D.show=function(){D.visible=!0,c.object.preventDrag=!0,p.setPreviewImg("#preview_"+c.layout.qInfo.qId,"#wiWidgetPreviewImg_"+c.layout.qInfo.qId)},D.hide=function(){D.visible=!1,c.object.preventDrag=!1},D.export=function(){D.Export.less=c.WidgetEditor.less,D.Export.html=c.WidgetEditor.html,D.Export.data=e.toJson(c.layout,!0),D.Export.previewImgSelector="#wiWidgetPreviewImg_"+c.layout.qInfo.qId,o.isBlank(c.WidgetEditor.PopupExport.Export.FileName)&&(D.Export.FileName="qWidget_"+(new Date).yyyymmdd()),n.export(D.Export)},c.WidgetEditor.PopupExport=D;var E={};c.WorkingArea=E;var F={};F.visible=!1,E.About=F,F.show=function(){a("#wipopup").showComponent(y,{visible:!0,layout:c.layout,ext:c.$parent.ext}),F.visible=!0},F.hide=function(){F.visible=!1};var G={};G.visible=!1,G.show=function(){G.visible=!0,a("#wipopup").showComponent(B,{Main:c.Main})},G.hide=function(){G.visible=!1},E.UpdateInfo=G;var H={};H.visible=!1,H.show=function(b){function d(){}function e(b){if("local"===b.src){var d="/extensions/qwidget/snippets/"+b.key+".txt";g.get(d).then(function(b){c.WidgetEditor.insert(b.data,!1),a("#popup").empty()})}else c.WidgetEditor.insert(b.code,!1),j.trackSnippetUse(b),a("#popup").empty()}c.Main.MainRepository.initialized&&c.Main.MainRepository.snippets.length>0?a("#wipopup").showComponent(t,{snippets:c.Main.MainRepository.snippets,loadedFrom:"Snippets from Online-Repository",loading:!1,filter:"",trackSearch:d,insert:e}):c.Main.LocalRepository.initSnippets().then(function(){a("#wipopup").showComponent(t,{snippets:c.Main.MainRepository.snippets,loadedFrom:"Snippets from Local-Repository",loading:!1,filter:"",trackSearch:d,insert:e})}).catch(function(a){c.Main.raiseError(a.error,a.errorStatus)}),c.WidgetEditor.popupTarget=b,c.object.preventDrag=!0},c.WidgetEditor.PopupSnippets=H;var I={};I.PublishingModes=m.PublishForm_PublishingModes;var J=b.find(I.PublishingModes,function(a){return"new"===a.value});I.visible=!1,I.view="",I.isLoading=!1,I.publishingSucceeded=null,I.serverNotReachable=!1,I.error=null,I.errorHandler=function(a){I.view="error",I.error=a,401===a.errorStatus&&c.Main.SelectedOnlineRepository.checkAuthentication()},I.clearError=function(){I.view="",I.error=void 0},I.SelectedPublishingRepository=null,I.SelectedPublishingMode=J,I.show=function(){var d=this;a("#wipopup").showComponent(x,{WidgetPublisher:d,Main:c.Main}),I.view="form",I.isLoading=!1,I.visible=!0,I.pubError=null,I.SelectedPublishingMode=J,delete I.Widget,I.Widget={};var f="#preview_"+c.layout.qInfo.qId,g="#wiWidgetPreviewImg_"+c.layout.qInfo.qId,h=p.setPreviewImg(f,g);h.then(function(){if(e.noop(),I.SelectedWidgetToUpdate=null,c.Main.SelectedRepository&&"ws"===c.Main.SelectedRepository.type)return I.SelectedPublishingRepository=c.Main.SelectedRepository,I.Repository_OnChange(c.Main.SelectedRepository);var a=b.filter(c.Main.RepositoryList,function(a){return a.allowsPublishing===!0});return 1===a.length?(I.SelectedPublishingRepository=a[0],I.Repository_OnChange(a[0])):void I.initForm()})},I.initForm=function(a){I.isLoading=!0,!a&&c.Main.SelectedRepository&&"ws"===c.Main.SelectedRepository.type&&(a=c.Main.SelectedRepository),a?c.Main.OnlineRepositoryService.getInstance(a,!0).then(function(b){b.initCategories().then(function(){I.SelectedPublishingRepository=a,c.Main.SelectedOnlineRepository=b}).catch(I.errorHandler)}).catch(I.errorHandler).finally(function(){I.isLoading=!1}):I.isLoading=!1},I.hide=function(){I.visible=!1},I.Widget={},I.includeData=!1,I.isPrivate=!1,I.selectedCategory=null,I.loadingOwnWidgets=!1,I.OwnWidgets=null,I.loadOwnWidgets=function(){"update"===I.SelectedPublishingMode.value&&(I.loadingOwnWidgets=!0,h.getMyWidgets(c.WidgetPublisher.SelectedPublishingRepository).then(function(a){I.OwnWidgets=a}).catch(I.errorHandler))},I.Repository_OnChange=function(a){I.clearError(),c.Main.SelectedRepository=a,I.initForm(a)},I.PublishingMode_OnChange=function(a){"update"===a.value?I.loadOwnWidgets():I.SelectedWidgetToUpdate=void 0},I.applyOwnWidget=function(a){I.Widget.name=a.name,I.Widget._id=a._id,I.Widget.is_private=a.is_private,I.Widget.description=a.description;var d=b.find(c.Main.SelectedOnlineRepository.categories,function(b){return b._id===a.category._id});I.selectedCategory=d},I.submit=function(){if(I.isLoading===!1){I.view="publishing",I.isLoading=!0;var a="#preview_"+c.layout.qInfo.qId,b="#wiWidgetPreviewImg_"+c.layout.qInfo.qId,d=p.setPreviewImg(a,b);d.then(function(a){var b=a.getContext("2d");b.webkitImageSmoothingEnabled=!1,b.mozImageSmoothingEnabled=!1,b.imageSmoothingEnabled=!1;var d=a.toDataURL("image/png",1);I.Widget.preview_img=d,I.Widget.html=c.WidgetEditor.html,I.Widget.less=c.WidgetEditor.less,I.Widget.category=I.selectedCategory._id,I.includeData===!0&&(I.Widget.data=e.toJson(c.layout,!0)),I.Widget.is_responsive=!1,c.Main.OnlineRepositoryService.getInstance(I.SelectedPublishingRepository).then(function(a){a.postWidget(I.Widget).then(function(a){I.view="confirmation"}).catch(I.errorHandler).finally(function(){I.isLoading=!1})}).catch(I.errorHandler).finally(function(){e.noop()})})}},c.$watch("WidgetPublisher.visible",function(a){c.object.preventDrag=a}),c.WidgetPublisher=I,c.WidgetPublisher.Category_OnChanged=function(a){};var K={};K.visible=!1,K.loading=!1,K.show=function(){function b(a){return a.cat===K.searchFilter}if(K.icons)a("#wipopup").showComponent(v,{icons:K.icons,iconSize:"fa-lg",iconSizes:m.IconSizes,searchFilter:b,insertString:c.WidgetEditor.insert});else{K.loading=!0;var d="/extensions/qwidget/data/icons/icons-fa.json";g.get(d).then(function(d){K.icons=d.data.icons,a("#wipopup").showComponent(v,{icons:K.icons,iconSize:"fa-lg",iconSizes:m.IconSizes,searchFilter:b,insertString:c.WidgetEditor.insert})})}},K.icons=null,K.searchTerm="",c.WidgetEditor.PopupIcons=K;var L={};L.visible=!1,L.show=function(){a("#wipopup").showComponent(w,{src:"/extensions/qwidget/docs/index.html"})},c.WidgetEditor.PopupHelp=L,c.WidgetEditor.htmlChanged=function(){c.WidgetEditor.setPreview()},c.WidgetEditor.lessChanged=function(){c.WidgetEditor.setPreview()},c.WidgetEditor.setPreview=function(){c.WidgetEditor.html=c.WidgetEditor.htmlEditor().getValue();var a=c.WidgetEditor.lessEditor().getValue();c.WidgetEditor.less=a},c.WidgetEditor.applyWidgetData=function(){f.applyEditor(c),c.Main.showEditor=!1};var M={};M.WidgetList=null,M.selectedWidget=null,M.visible=!1,M.repositoryNotReachable=!1,M.SortOptions=[{label:"By Name",field:"name"},{label:"By Category",field:"category.name"},{label:"By Author",field:"author.full_name"},{label:"By Date",field:"creation_date"}],M.previewImgVisible=!0,M.togglePreview=function(a){M.previewImgVisible=a},M.SortOrder="ascending",M.toggleSortOrder=function(){M.SortOrder="ascending"===M.SortOrder?"descending":"ascending"},M.PrivateOnly=!1,M.toggleFilter_Private=function(){M.PrivateOnly=M.PrivateOnly!==!0},M.privateFilter=function(a){return!M.PrivateOnly||M.PrivateOnly&&a.is_private},M.canDelete=function(a){var d=b.indexOf(c.Main.SelectedOnlineRepository.authentication.roles,"ADMIN")>-1,e=a.author._id===c.Main.SelectedOnlineRepository.authentication.userId;return d||e},M.loadWidgets=function(a){M.WidgetList=void 0;var b=c.Main.SelectedRepository;"local"===b.type?M.loadWidgetsFromLocal():(c.WidgetLoader.loading=!0,c.Main.OnlineRepositoryService.getInstance(b,a).then(function(b){c.Main.SelectedOnlineRepository=b,b.isOnline&&b.authentication.isAuthenticated===!0&&b.initWidgets(a).then(function(){c.WidgetLoader.WidgetList=b.widgets,c.WidgetLoader.selectedWidget=void 0}).catch(function(a){c.Main.raiseError("Could not load qWidgets from web service",a.errorStatus,a.error)})}).catch(function(a){c.Main.errorHandler(a)}).finally(function(){c.WidgetLoader.loading=!1}))},M.loadWidgetsFromLocal=function(){c.WidgetLoader.loading=!0,c.Main.LocalRepository.initWidgets().then(function(){c.WidgetLoader.selectedWidget=void 0,c.WidgetLoader.WidgetList=c.Main.LocalRepository.widgets}).catch(function(a){c.Main.raiseError(a.error,a.errorStatus)}).finally(function(){M.repositoryNotReachable=!1,c.WidgetLoader.loading=!1})},M.deleteWidget=function(a){c.Main.SelectedOnlineRepository.deleteWidget(a).then(function(){}).catch(c.Main.errorHandler)},M.use=function(){c.WidgetEditor.html=c.widgetPreview.html,c.WidgetEditor.css=c.widgetPreview.css,c.WidgetEditor.less=c.widgetPreview.less,c.WidgetEditor.bind(),c.Main.editMode="create","ws"===c.Main.SelectedRepository.type&&h.useWidget(c.Main.SelectedRepository,M.selectedWidget._id)},M.preview=function(a){c.WidgetLoader.selectedWidget=a,c.WidgetLoader.loadingPreview=!0,"local"===c.Main.SelectedRepository.type?(k.getWidgetDetails(a).then(function(b){a.html=b[0].data,a.less=b[1].data,a.data=b[2].data,c.WidgetLoader.applyPreview(a)}).catch(function(a){c.Main.raiseError("An error occurred while loading a local widget",null,a)}),c.WidgetLoader.applyPreview(a)):c.Main.OnlineRepositoryService.getInstance(c.Main.SelectedRepository).then(function(b){b.getWidgetDetails(a).then(function(d){c.WidgetLoader.applyPreview(d),b.trackPreview(a._id)}).catch(function(a){c.Main.raiseError("Could not load widget details",a.errorSatus,a.error)})}).catch(c.Main.errorHandler)},M.applyPreview=function(a){c.widgetPreview={},i(function(){c.widgetPreview.less=a.less||""},0).then(function(){c.widgetPreview.html=a.html,c.widgetPreview.data=a.data||""}).then(function(){c.widgetPreview.PreviewImg=a.preview_img,b.isEmpty(c.widgetPreview.PreviewImg)&&(c.WidgetLoader.previewImgVisible=!1)}).then(function(){c.WidgetLoader.loadingPreview=!1})},M.init=function(){var a=c.Main.SelectedRepository;null===a?(c.Main.SelectedRepository=b.find(c.Main.RepositoryList,function(a){return"local"===a.type}),M.loadWidgetsFromLocal()):M.loadWidgets(!0)},M.Repository_OnChange=function(){M.loadWidgets(!1)},c.WidgetLoader=M,c.$watch("WidgetLoader.visible",function(a){c.object.preventDrag=a}),c.$watch("Main.editMode",function(a){"load"===a?(c.WidgetLoader.visible=!0,c.WidgetLoader.init()):"create"===a&&(c.WidgetLoader.visible=!1,c.WidgetEditor.bind())}),c.$watch("$parent.$parent.editmode",function(a){a===!1&&(c.Main.showEditor=!1,c.Main.endEditing())}),c.$watch("layout.clientVersion",function(a){void 0!==a&&"=Qli"!==a.substr(0,4)&&i(function(){c.Main.setClientVersion()},100)}),c.initWidget()}]}});