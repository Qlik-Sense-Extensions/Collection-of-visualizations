var visualize=function(e,t,a,o){var l=t.qInfo.qId+"_chartjs_stacked_bar",i=o.calculateMargin(e,t),s=i[0],n=i[1];e.html('<canvas id="'+l+'" width="'+s+'" height="'+n+'"></canvas>');var r=[];r="auto"==t.colors?o.defineColorPalette(t.color_selection):t.custom_colors.split("-");var c=t.qHyperCube.qDataPages[0].qMatrix,u=o.flattenData(c),d=u[0],b=u[1],m=u[2];t.sort&&b.sort();var p=_.groupBy(d,"dim1"),h=[];h.dim1=[],h.dim1_elem=[],h=o.initializeArrayWithZero(_.size(p),b,h),h=o.storeHypercubeDataToArray(p,h),t.cumulative&&(h=o.addCumulativeValuesOnTwoDimensions(b,h));for(var g=[],v=0;v<b.length;v++){var y=[],f=v;"auto"==t.colors&&"twelve"==t.color_selection?f=v%12:"auto"==t.colors&&"one-handred"==t.color_selection?f=v%100:"custom"==t.colors&&(f=v%r.length),y.label=b[v],y.backgroundColor="rgba("+r[f]+","+t.opacity+")",y.data=h[b[v]],y.fill=t.background_color_switch,y.borderColor="rgba("+r[f]+","+t.opacity+")",y.pointBackgroundColor="#FFFFFF",y.pointRadius=t.point_radius_size,g.push(y)}var k={labels:h.dim1,datasets:g},q=document.getElementById(l);new Chart(q,{type:"line",data:k,options:{title:{display:t.title_switch,text:t.title},legend:{display:"hide"!=t.legend_position,position:t.legend_position,onClick:function(e,t){var o=[],l=1;m[t.text]<0||(o.push(m[t.text]),a.selectValues(l,o,!0))}},scales:{xAxes:[{scaleLabel:{display:t.datalabel_switch,labelString:t.qHyperCube.qDimensionInfo[0].qFallbackTitle}}],yAxes:[{scaleLabel:{display:t.datalabel_switch,labelString:t.qHyperCube.qMeasureInfo[0].qFallbackTitle},ticks:{beginAtZero:t.begin_at_zero_switch,callback:function(e,a,l){return o.formatMeasure(e,t,0)}}}]},tooltips:{mode:"label",callbacks:{label:function(e,a){return a.datasets[e.datasetIndex].label+": "+o.formatMeasure(e.yLabel,t,0)}}},responsive:!0,events:["mousemove","mouseout","click","touchstart","touchmove","touchend"],onClick:function(e){var t=this.getElementsAtEvent(e);t.length>0&&o.makeSelectionsOnDataPoints(h.dim1_elem[t[0]._index],a)}}})};